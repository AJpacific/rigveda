@import "tailwindcss";

:root {
  /* Palette */
  --parchment: #F5F0E1ff;
  --terracotta: #D9822Bff;
  --deep-maroon: #6B1E14ff;
  --olive-green: var(--burnt-umber);
  --midnight-blue: #1B3A4Bff;
  --gold: var(--burnt-umber);
  --light-cream: #FFF8E7ff;
  --burnt-umber: #8A4B2Dff;

  /* Role mapping â€“ Light (default) */
  --background: var(--parchment);
  --foreground: var(--midnight-blue);
  --surface: rgba(138, 75, 45, 0.06); /* burnt-umber @ 6% */
  --surface-strong: rgba(138, 75, 45, 0.18); /* burnt-umber @ 18% */
  --primary: var(--burnt-umber);
  --primary-600: #734129; /* darker burnt-umber */
  --accent: var(--deep-maroon);
  --muted: #6f6a63; /* neutral text */
}

/* Dark theme overrides */
html.dark {
  --background: var(--midnight-blue);
  --foreground: var(--parchment);
  --surface: rgba(255, 255, 255, 0.06);
  --surface-strong: rgba(255, 255, 255, 0.15);
  --primary: var(--burnt-umber);
  --primary-600: #734129;
  --accent: var(--burnt-umber);
  --muted: #c8c2b7;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-primary: var(--primary);
  --color-primary-600: var(--primary-600);
  --color-accent: var(--accent);
  --color-muted: var(--muted);
}

html { color-scheme: light dark; }

body {
  background: var(--background);
  color: var(--foreground);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
}

/* Utility polish */
.container { max-width: 1100px; }

a { color: var(--burnt-umber); }
a:hover { color: var(--primary); }

/* Card surface helpers */
.card-surface { background: var(--light-cream); border: 1px solid var(--burnt-umber); }

/* Icon buttons */
.icon-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 2rem;
  height: 2rem;
  border-radius: 0.75rem;
  border: 1px solid var(--burnt-umber);
  background: white;
  color: var(--midnight-blue);
  transition: background 0.2s ease, color 0.2s ease;
}
.icon-btn:hover {
  background: var(--surface);
  color: var(--midnight-blue);
}

.nav-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 2.25rem;
  height: 2.25rem;
  border-radius: 0.75rem;
  border: 1px solid var(--burnt-umber);
  background: white;
  color: var(--midnight-blue);
  transition: background 0.2s ease, color 0.2s ease, opacity 0.2s ease, transform 0.2s ease;
}
.nav-btn:hover {
  background: var(--surface);
  color: var(--midnight-blue);
  transform: translateY(-1px);
}
.nav-btn-disabled {
  opacity: 0.35;
  pointer-events: none;
}

/* Material Design tokens and components (palette preserved) */

/* Elevation tokens (shadows tuned for soft parchment palette) */
.m-elevation-0 { box-shadow: none; }
.m-elevation-1 { box-shadow: 0 1px 2px rgba(27,58,75,0.06), 0 1px 1px rgba(27,58,75,0.04); }
.m-elevation-2 { box-shadow: 0 2px 6px rgba(27,58,75,0.08), 0 1px 2px rgba(27,58,75,0.06); }
.m-elevation-3 { box-shadow: 0 4px 10px rgba(27,58,75,0.10), 0 2px 4px rgba(27,58,75,0.06); }
.m-elevation-4 { box-shadow: 0 6px 14px rgba(27,58,75,0.12), 0 2px 6px rgba(27,58,75,0.06); }
.m-elevation-5 { box-shadow: 0 8px 18px rgba(27,58,75,0.14), 0 4px 8px rgba(27,58,75,0.08); }

/* App bar */
.m-appbar {
  position: sticky;
  top: 0;
  z-index: 40;
  backdrop-filter: blur(8px);
  /* Slightly tinted surface to separate from page background */
  background: color-mix(in oklab, var(--primary) 14%, var(--background));
  border: 1px solid var(--surface-strong);
  box-shadow: 0 1px 2px rgba(27,58,75,0.06), 0 1px 1px rgba(27,58,75,0.04);
  border-radius: 0.9rem;
}
.dark .m-appbar { background: color-mix(in oklab, var(--primary) 22%, var(--background)); }
.m-appbar-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
}
.m-appbar-title {
  font-weight: 700;
  letter-spacing: 0.02em;
  color: var(--midnight-blue);
}
.dark .m-appbar-title { color: var(--parchment); }

/* Sub App bar (for in-page sticky sections below global header) */
.m-subappbar {
  position: sticky;
  top: var(--global-appbar-height, 56px);
  z-index: 35;
  backdrop-filter: blur(8px);
  background: color-mix(in oklab, var(--primary) 10%, var(--background));
  border-bottom: 1px solid var(--surface-strong);
  box-shadow: 0 1px 2px rgba(27,58,75,0.06), 0 1px 1px rgba(27,58,75,0.04);
  border-radius: 0.9rem;
}
.dark .m-subappbar { background: color-mix(in oklab, var(--primary) 18%, var(--background)); }

/* Cards */
.m-card {
  border: 1px solid var(--surface-strong);
  background: white;
  color: var(--midnight-blue);
  border-radius: 0.9rem;
}
.dark .m-card { background: color-mix(in oklab, black 20%, transparent); color: var(--parchment); }

/* Buttons */
.m-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  font-weight: 600;
  border-radius: 0.65rem;
  line-height: 1;
  transition: transform 0.1s ease, opacity 0.15s ease, background 0.15s ease;
}
.m-btn:active { transform: translateY(1px); }
.m-btn:disabled { opacity: 0.5; pointer-events: none; }

.m-btn-filled {
  background: var(--primary);
  color: white;
  border: 1px solid var(--primary-600);
  padding: 0.6rem 0.9rem;
}
.m-btn-filled:hover { background: var(--primary-600); }

.m-btn-tonal {
  background: color-mix(in oklab, var(--primary) 12%, white);
  color: var(--midnight-blue);
  border: 1px solid var(--surface-strong);
  padding: 0.6rem 0.9rem;
}
.m-btn-tonal:hover { background: color-mix(in oklab, var(--primary) 16%, white); }

.m-btn-outlined {
  background: transparent;
  color: var(--midnight-blue);
  border: 1px solid var(--surface-strong);
  padding: 0.55rem 0.9rem;
}
.m-btn-outlined:hover { background: var(--surface); }

.m-btn-text {
  background: transparent;
  color: var(--primary);
  border: 1px solid transparent;
  padding: 0.4rem 0.5rem;
}
.m-btn-text:hover { background: var(--surface); }

/* Fixed small button width helpers */
.m-btn-fixed-xs { min-width: 2.5rem; }
.m-btn-fixed-sm { min-width: 6rem; }

/* Text field */
.m-field {
  display: grid;
  grid-template-areas: 'input';
}
.m-input {
  grid-area: input;
  width: 100%;
  padding: 0.75rem 0.9rem;
  border-radius: 0.8rem;
  border: 1px solid var(--surface-strong);
  background: color-mix(in oklab, white 80%, transparent);
  color: var(--midnight-blue);
  outline: none;
}
.m-input::placeholder { color: var(--muted); }
.m-input:focus { box-shadow: 0 0 0 2px color-mix(in oklab, var(--primary) 35%, transparent); }
.dark .m-input { background: color-mix(in oklab, black 25%, transparent); color: var(--parchment); }

/* Dialog */
.m-dialog-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.75rem;
  z-index: 50;
  overscroll-behavior: contain;
}
.m-dialog {
  width: 100%;
  max-width: 40rem;
  max-height: 85vh;
  border-radius: 1rem;
  border: 1px solid var(--surface-strong);
  background: white;
  color: var(--midnight-blue);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.dark .m-dialog { background: color-mix(in oklab, black 25%, transparent); color: var(--parchment); }
.m-dialog-header { display: flex; align-items: center; justify-content: space-between; padding: 0.9rem 1rem; border-bottom: 1px solid var(--surface-strong); }
.m-dialog-body { padding: 0.9rem 1rem; overflow: auto; flex: 1 1 auto; -webkit-overflow-scrolling: touch; }
.m-dialog-footer { padding: 0.9rem 1rem; border-top: 1px solid var(--surface-strong); }

/* Plain dialog variant (no section borders) */
.m-dialog-plain .m-dialog-header { border-bottom: none; padding-bottom: 0; }
.m-dialog-plain .m-dialog-footer { border-top: none; padding-top: 0; }
.m-dialog-plain .m-dialog-body { padding-top: 0.5rem; padding-bottom: 0.5rem; }

/* Dividers */
.m-divider { height: 1px; background: var(--surface-strong); width: 100%; }

/* Assistive colors */
.text-muted { color: var(--muted); }
.text-accent { color: var(--accent); }
.text-primary { color: var(--primary); }
.bg-surface { background: var(--surface); }

/* Sanskrit token hover highlight */
.sanskrit-token {
  border-radius: 0.4rem;
  padding: 0.1rem 0.25rem;
  transition: background 0.15s ease, box-shadow 0.15s ease;
}
.sanskrit-token:hover {
  background: var(--surface);
  box-shadow: inset 0 0 0 1px var(--surface-strong);
}
.sanskrit-token:focus-visible {
  outline: none;
  box-shadow: inset 0 0 0 2px color-mix(in oklab, var(--primary) 35%, transparent);
}

/* Scroll lock helper when modal open */
html.no-scroll, body.no-scroll { overflow: hidden; overscroll-behavior: contain; }

/* Google CSE in dialog */
.m-dialog-body .gsc-control-cse {
  background: transparent !important;
  border: none !important;
  padding: 0 !important;
}
.m-dialog-body .gsc-search-box {
  margin-bottom: 0.75rem !important;
}

/* Wide dialog option */
.m-dialog.wide { max-width: 64rem; }

/* Embedded result frame inside dialog */
.m-embed-container { width: 100%; height: min(65vh, 800px); }
.embedded-frame {
  width: 100%;
  height: 100%;
  border: 1px solid var(--surface-strong);
  border-radius: 0.5rem;
  background: white;
  display: block;
}

/* Enable pinch-zoom on embedded external pages only */
.m-embed-container { touch-action: pinch-zoom; }

/* Allow vertical scrolling inside dialogs on mobile */
.m-dialog { touch-action: pan-y; }
.m-dialog-body { touch-action: pan-y; }

/* Keep background from handling gestures when overlay is present */
.m-dialog-overlay { touch-action: none; }

/* Sticky note footer (keeps helper text visible) */
.m-note-foot {
  position: sticky;
  bottom: 0;
  padding-top: 0.5rem;
  background: linear-gradient(to top, rgba(255,255,255,0.96), rgba(255,255,255,0.7) 50%, transparent);
}
.dark .m-note-foot {
  background: linear-gradient(to top, rgba(0,0,0,0.92), rgba(0,0,0,0.55) 50%, transparent);
}

/* Audio footer */
.m-audiofooter {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 45;
  backdrop-filter: blur(8px);
  background: color-mix(in oklab, var(--primary) 10%, var(--background));
  border-top: 1px solid var(--surface-strong);
  box-shadow: 0 -1px 2px rgba(27,58,75,0.06), 0 -1px 1px rgba(27,58,75,0.04);
}
.dark .m-audiofooter { background: color-mix(in oklab, var(--primary) 18%, var(--background)); }
@supports (padding: env(safe-area-inset-bottom)) {
  .m-audiofooter { padding-bottom: calc(env(safe-area-inset-bottom)); }
}

@media (max-width: 640px) {
  .m-dialog { max-width: 100%; max-height: 92dvh; }
  .m-dialog-body { padding: 0.75rem; }
  .m-embed-container { height: 70dvh; }
}
